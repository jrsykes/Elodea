/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/detr/image_processing_detr.py:776: FutureWarning: The `max_size` parameter is deprecated and will be removed in v4.26. Please specify in `size['longest_edge'] instead`.
  FutureWarning,
Learning... |                                | 0/28/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/detr/image_processing_detr.py:859: FutureWarning: The `max_size` parameter is deprecated and will be removed in v4.26. Please specify in `size['longest_edge'] instead`.
  FutureWarning,
loading annotations into memory...
Done (t=0.00s)
creating index...
index created!
loading annotations into memory...
Done (t=0.00s)
creating index...
index created!
Number of training examples: 111
Number of validation examples: 14
Epoch 99
----------
Patience: 50/50
train
/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/detr/image_processing_detr.py:776: FutureWarning: The `max_size` parameter is deprecated and will be removed in v4.26. Please specify in `size['longest_edge'] instead`.
  FutureWarning,
/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/detr/image_processing_detr.py:941: FutureWarning: This method is deprecated and will be removed in v4.27.0. Please use pad instead.
  "This method is deprecated and will be removed in v4.27.0. Please use pad instead.", FutureWarning
[?25hTraceback (most recent call last):
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/userfs/j/jrs596/.vscode-server/extensions/ms-python.python-2022.18.2/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/__main__.py", line 39, in <module>
    cli.main()
  File "/home/userfs/j/jrs596/.vscode-server/extensions/ms-python.python-2022.18.2/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 430, in main
    run()
  File "/home/userfs/j/jrs596/.vscode-server/extensions/ms-python.python-2022.18.2/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 284, in run_file
    runpy.run_path(target, run_name="__main__")
  File "/home/userfs/j/jrs596/.vscode-server/extensions/ms-python.python-2022.18.2/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 322, in run_path
    pkg_name=pkg_name, script_name=fname)
  File "/home/userfs/j/jrs596/.vscode-server/extensions/ms-python.python-2022.18.2/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 136, in _run_module_code
    mod_name, mod_spec, pkg_name, script_name)
  File "/home/userfs/j/jrs596/.vscode-server/extensions/ms-python.python-2022.18.2/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 124, in _run_code
    exec(code, run_globals)
  File "/home/userfs/j/jrs596/scripts/Elodea/fine_tune_d-detr3.py", line 347, in <module>
    model = train_model(model=model, dataloaders_dict=dataloaders_dict, optimizer=optimizer, patience=args.patience)
  File "/home/userfs/j/jrs596/scripts/Elodea/fine_tune_d-detr3.py", line 151, in train_model
    outputs = model(pixel_values=pixel_values, pixel_mask=pixel_mask, labels=labels)
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/deformable_detr/modeling_deformable_detr.py", line 1917, in forward
    inputs_embeds=inputs_embeds,
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/deformable_detr/modeling_deformable_detr.py", line 1691, in forward
    #level_start_index = torch.cat((spatial_shapes.new_zeros((1,)), torch.prod(spatial_shapes, 1).cumsum(0)[:-1]))
RuntimeError: CUDA driver error: invalid argument