/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/detr/image_processing_detr.py:776: FutureWarning: The `max_size` parameter is deprecated and will be removed in v4.26. Please specify in `size['longest_edge'] instead`.
  FutureWarning,
loading annotations into memory...
Done (t=0.02s)
creating index...
index created!
loading annotations into memory...
Done (t=0.01s)
creating index...
index created!
Number of training examples: 111
Number of validation examples: 14
Learning... |                                | 0/28/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/detr/image_processing_detr.py:859: FutureWarning: The `max_size` parameter is deprecated and will be removed in v4.26. Please specify in `size['longest_edge'] instead`.
  FutureWarning,
Epoch 99
----------
Patience: 50/50
train
/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/detr/image_processing_detr.py:941: FutureWarning: This method is deprecated and will be removed in v4.27.0. Please use pad instead.
  "This method is deprecated and will be removed in v4.27.0. Please use pad instead.", FutureWarning
[?25hTraceback (most recent call last):
  File "/home/userfs/j/jrs596/scripts/Elodea/fine_tune_d-detr3.py", line 347, in <module>
    model = train_model(model=model, dataloaders_dict=dataloaders_dict, optimizer=optimizer, patience=args.patience)
  File "/home/userfs/j/jrs596/scripts/Elodea/fine_tune_d-detr3.py", line 151, in train_model
    outputs = model(pixel_values=pixel_values, pixel_mask=pixel_mask, labels=labels)
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/deformable_detr/modeling_deformable_detr.py", line 1988, in forward
    loss_dict = criterion(outputs_loss, labels)
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/deformable_detr/modeling_deformable_detr.py", line 2221, in forward
    indices = self.matcher(outputs_without_aux, targets)
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/torch/nn/modules/module.py", line 1190, in _call_impl
    return forward_call(*input, **kwargs)
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/deformable_detr/modeling_deformable_detr.py", line 2355, in forward
    giou_cost = -generalized_box_iou(center_to_corners_format(out_bbox), center_to_corners_format(target_bbox))
  File "/local/scratch/jrs596/envs/d-detr2/lib/python3.7/site-packages/transformers/models/deformable_detr/modeling_deformable_detr.py", line 2419, in generalized_box_iou
    if not (boxes1[:, 2:] >= boxes1[:, :2]).all():
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call,so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.